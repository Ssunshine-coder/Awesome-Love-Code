<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>一封情书</title>
    <link rel="icon" type="image/x-icon" href="https://i.loli.net/2021/06/03/lFg2V4WUcmkB98G.png">
    <meta name="language" content="zh-CN">
    <meta name="title" content="小孙同学">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="./Love_files/default.css">
    
    <script type="text/javascript" src="./Love_files/jquery.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-parser.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-jit.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-builderbase.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async-powerpack.min.js"></script>
    <script type="text/javascript" src="./Love_files/functions.js" charset="utf-8"></script>
    <script type="text/javascript" src="./Love_files/love.js" charset="utf-8"></script>

    <style>
        /* --- CSS 样式调整区域 --- */
        
        /* 1. 全局应用“马善政”书法字体，如果没有网则回退到楷体 */
        body, div, span, p {
            font-family: "Ma Shan Zheng", "KaiTi", "STKaiti", "Microsoft YaHei", serif;
        }

        p {
            margin: 0;
        }

        #code {
            /* 字体大小微调，书法体通常需要大一点才好看 */
            font-size: 22px; 
            line-height: 1.8; /* 增加行间距，让书法字不拥挤 */
            display: none;
            color: #333;
            
            /* 限制高度并开启滚动条 */
            width: 480px;
            height: 520px;
            overflow-y: auto;
            padding-right: 15px;
            margin-top: 10px;
            
            /* 开启平滑滚动 */
            scroll-behavior: smooth;
        }

        /* 段落排版 */
        #code p {
            text-indent: 2em;
            margin-bottom: 1em;
        }
        
        #code p.say_title {
            text-indent: 0;
            font-size: 24px; /* 标题大一点 */
            margin-bottom: 20px;
        }
        #code p.say_date {
            text-indent: 0;
            text-align: right;
            margin-top: 30px;
        }

        /* 重点强调样式 */
        .highlight {
            color: #ff0000; 
            font-weight: bold; /* 书法体加粗效果可能不明显，靠颜色区分 */
            font-size: 1.1em;
        }

        /* --- 关键修改：计时器位置 --- */
        /* 移到【左下角】，彻底解决挡树问题，且视觉更平衡 */
        #clock-box {
            position: absolute;
            bottom: 20px;
            left: 60px;  /* 放在左边 */
            right: auto; /* 清除右边定位 */
            font-size: 16px;
            text-align: left; /* 文字左对齐 */
            color: #666;
            z-index: 999;
        }
        /* 计时器数字样式 */
        #clock .digit {
            font-size: 28px; /* 数字大一点 */
            font-family: "Ma Shan Zheng", cursive; /* 数字也用书法体 */
        }

        /* --- 滚动条美化 --- */
        #code::-webkit-scrollbar {
            width: 6px; /* 变细一点，更精致 */
        }
        #code::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.5); 
            border-radius: 4px;
        }
        #code::-webkit-scrollbar-thumb {
            background: #ffb7c5; 
            border-radius: 4px;
        }
        #code::-webkit-scrollbar-thumb:hover {
            background: #ff69b4;
        }
    </style>
</head>

<body>
    <div id="main">
        <div id="error">亲，您使用的浏览器无法支持即将显示的内容，请换成谷歌(<a
                href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-CN&brand=CHMI">Chrome</a>)或者火狐(<a
                href="http://firefox.com.cn/download/">Firefox</a>)浏览器哟~</div>
        
        <div id="wrap">
            <div id="text">
                <div id="code">
                    <p class="say_title">致 Ssunshine：</p>
                    
                    <p class="say">今天是4月1日，一个适合说真话的日子。因为即便被当作玩笑，至少心意说出口了。</p>
                    <p class="say">窗外春天已经很深了，我坐在桌前，想起马尔克斯在《霍乱时期的爱情》里写的那句话：“生活规律得仿佛生了锈一般，既让人轻蔑，又让人害怕，但同时也是一种保护，让他意识不到时间的流逝。”</p>
                    <p class="say">直到你出现，像是在平静的湖面投下一颗石子，涟漪一圈圈荡开，再也回不到从前的平静。</p>

                    <p class="say">记得“不太想联系了”那次吗？那次名字的事，你觉得我不信任你。你说“不好意思我不喜欢这种感觉和不信任”，然后是那句——“不太想联系了”。</p>
                    <p class="say">那天之后，你的朋友圈置顶了“顺利”两个字。我看到的时候愣住了，盯着那两个字看了很久。我不知道那是不是给我看的，但那一刻心里突然慌了。原来在意一个人，是会怕失去的，哪怕我们之间还没有真正开始。后来我才知道，那应该是给我看的。</p>
                    <p class="say">那几天手机放在手边，屏幕每次亮起都会下意识看一眼。夜里躺在床上会想，是不是真的就这样结束了？我们之间的故事，会不会就停在那个“顺利”上？</p>

                    <p class="say">博尔赫斯问：“我用什么才能留住你？”那时候我才明白这句话的重量。</p>
                    <p class="say">尽管我们从未见过面。隔着屏幕，隔着不知道多少公里的距离，甚至不知道彼此真实的样子。但就是这样，你的每一句话我都记得。</p>
                    <p class="say">你开导我的时候，那些温柔的字句像光一样照进来。你不会说教，不会敷衍，就是认真地听、认真地回应。每次和你聊完，心里那些乱七八糟的情绪都会慢慢沉淀下来。</p>
                    <p class="say">我总说你的名字里有阳光，其实不只是名字。你说话的语气、你对待事情的态度、你给人的感觉，都像春天的阳光——不刺眼，但很温暖，能让人想靠近。</p>

                    <p class="say">记得你分享过一首歌给我，《这世界那么多人》。你说你最喜欢那句“这世界有那么个人活在我飞扬的青春”。我听了很多遍，每次听到这句都会想：</p>
                    <p class="say"><span class="highlight">如果我也能成为活在你青春里的那个人，该有多好。</span></p>

                    <p class="say">这世界那么多人，而我遇见了你。就像小王子对狐狸说的：“正是你为你的玫瑰花费的时光，使你的玫瑰变得如此重要。”</p>
                    <p class="say">我和你的每一次对话，每一个为你心动的瞬间，都让你在我心里变得无可替代。你就像那朵玫瑰，在千千万万朵玫瑰中，因为我为你花费的时光，而变得独一无二。</p>
                    <p class="say">小王子还说：“只有用心才能看得清。实质性的东西，用眼睛是看不见的。”我们隔着屏幕，我看不见你，却早已用心感受到你的温暖。你开导我时的温柔，你唱歌时的动人——听过你唱的《去有风的地方遇见你》，那种感觉很难形容，就是让人想一直听下去，想循环播放。</p>

                    <p class="say">每次听到你的歌声都会想，如果真的能在某个有风的地方遇见你，会是什么样子？我想让这份看不见的感情，变成看得见的陪伴。想当面听你唱歌，想在以后的每一个日子里，都能听到你的歌声。</p>
                    <p class="say">我不是一个很主动的人，但在和你相处的过程中，我发现自己总是忍不住主动找你。想跟你说话，想跟你谈天说地，想和你分享生活里的点点滴滴。看到有趣的事会想告诉你，心情不好时会想找你倾诉，甚至只是想知道你今天过得怎么样。</p>
                    <p class="say"><span class="highlight">原来喜欢一个人，是会让人变得主动的。</span></p>

                    <p class="say">就像《玻璃心》里唱的那样，脆弱的心怕疼怕受伤害。我也曾害怕，害怕主动会换来失望，害怕表露真心会变得脆弱。村上春树说，哪里会有人喜欢孤独，不过是不喜欢失望罢了。</p>
                    <p class="say">可后来发现，有些感情不是可以一直藏着的。它会在某个瞬间溢出来，提醒我不能再自欺欺人。我厌倦了那种若即若离的状态，厌倦了把千言万语都克制在嘴边的感觉。与其在猜测中摇摆，我更想用一种确定的方式，把这份心意永远定格。</p>

                    <p class="say">这让我想起笛卡尔临终前画下的那条心形曲线 r=a(1-sinθ)。那是他用数学写下的最后情书，每一个坐标点都在诉说“我的心永远朝向你”。那条曲线证明了，有些原本无解的爱意，一旦找到了表达的公式，就可以穿越生死，被永远铭记。</p>
                    <p class="say">但仅有瞬间的铭记是不够的，还需要漫长的时光来铺垫。就像马孔多那场下了四年十一个月零两天的雨，马尔克斯说，生命中所有的灿烂都要用寂寞偿还。我想告诉你的是：如果这份寂寞能换来遇见你，那么，雨即使下得再久一点，也值得。</p>

                    <p class="say"><span class="highlight">所以今天，我想告诉你：我喜欢你。</span></p>
                    <p class="say">不是那种“聊得来”的喜欢，是真的喜欢。是看到你的消息会不自觉地笑，是想知道你在做什么、过得好不好，是想在你难过的时候陪着你，是想把那些一直没说出口的话说给你听。</p>
                    <p class="say">是想见你。想知道你真实的样子，想当面听你唱歌，想陪你去看星星，想和你一起看春花、赏夏荷、踏秋枫、等冬雪。想在这世界那么多人里，成为活在你青春里的那个人。</p>

                    <p class="say">如果你是sin，我是cos。我不求平方和等于 1的圆满，只求与你相除。因为相除便是相处。愿我们的故事像tan 曲线一样，始于心动，延伸至无穷。</p>
                    <p class="say">我们从 <span class="highlight">[陌生，爱)</span> 开始。左边是确定的起点，右边是无限趋近却永不停止的终点。而我想说，我愿意用余生的时间，和你一起在这条趋近于爱的路上，一直走下去。</p>

                    <p class="say">我知道这听起来有点不现实。我们隔得很远，也许你从来没有想过我们之间会是这样的关系。但泰戈尔说：“世界上最遥远的距离，不是生与死，而是我站在你面前，你却不知道我爱你。”</p>
                    <p class="say"><span class="highlight">我不想让这句话成为我们的结局。</span></p>

                    <p class="say">Ssunshine，我不会说那些“一定会如何如何”的话，因为未来谁都说不准。我只能告诉你此刻我的感受——我想和你试试看。想继续主动地关心你，想让你知道你对我来说很重要，想让我们之间有一个明确的关系。</p>
                    <p class="say">如果你愿意，我想从朋友变成更亲密的人。想有资格在你难过时给你拥抱，想有理由在每个早晨和你说早安，想有机会走进你的生活，也让你走进我的。想一直听你唱歌，想成为你愿意为之歌唱的那个人。</p>
                    <p class="say">如果你还需要时间，我可以等。如果你觉得我们还需要更了解彼此，我也愿意。我只是不想再假装若无其事，不想再把这份喜欢藏起来。</p>

                    <p class="say">今天是愚人节，但加缪说：“不要走在我后面，因为我可能不会引路；不要走在我前面，因为我可能不会跟随；请走在我身边，做我的朋友。”</p>
                    <p class="say">而我想说：</p>
                    <p class="say"><span class="highlight">请走在我身边，让我画出那条属于我们的心形曲线。</span></p>

                    <p class="say">这不是玩笑，是我最认真的心意！</p>
                    
                    <p class="say_date">-- 2026年4月1日</p>
                </div>
            </div>
            
            <div id="clock-box">
                我与你相识的
                <div id="clock"></div>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>
    </div>

    <audio preload="auto" autoplay="" id="media" src="love.mp3" loop="loop"></audio>

    <script>
        (function () {
            
            // --- 【大招：重写打字机函数】 ---
            // 解决：1. 速度调节 (改为 150ms) 2. 自动跟随滚动 (每打一个字就滚到底)
            $.fn.typewriter = function() {
                this.each(function() {
                    var $ele = $(this), str = $ele.html(), progress = 0;
                    $ele.html('');
                    var timer = setInterval(function() {
                        var current = str.substr(progress, 1);
                        if (current == '<') {
                            // 如果遇到标签，直接找到闭合处
                            progress = str.indexOf('>', progress) + 1;
                        } else {
                            progress++;
                        }
                        
                        // 打印内容
                        $ele.html(str.substring(0, progress) + (progress & 1 ? '_' : ''));
                        
                        // 【关键逻辑】自动跟随滚动
                        // 获取DOM元素直接操作 scrollTop
                        var codeDiv = document.getElementById('code');
                        if (codeDiv) {
                            codeDiv.scrollTop = codeDiv.scrollHeight;
                        }

                        // 结束判断
                        if (progress >= str.length) {
                            clearInterval(timer);
                        }
                    }, 150); // 【这里调节速度】：150 是 150毫秒，数字越大越慢
                });
                return this;
            };
            // -----------------------------

            var canvas = $('#canvas');
            if (!canvas[0].getContext) {
                $("#error").show();
                return false;
            }

            var width = canvas.width();
            var height = canvas.height();
            canvas.attr("width", width);
            canvas.attr("height", height);

            var opts = {
                seed: {
                    x: width / 2 - 20,
                    color: "rgb(190, 26, 37)",
                    scale: 2
                },
                branch: [
                    [535, 680, 570, 250, 500, 200, 30, 100, [
                        [540, 500, 455, 417, 340, 400, 13, 100, [
                            [450, 435, 434, 430, 394, 395, 2, 40]
                        ]],
                        [550, 445, 600, 356, 680, 345, 12, 100, [
                            [578, 400, 648, 409, 661, 426, 3, 80]
                        ]],
                        [539, 281, 537, 248, 534, 217, 3, 40],
                        [546, 397, 413, 247, 328, 244, 9, 80, [
                            [427, 286, 383, 253, 371, 205, 2, 40],
                            [498, 345, 435, 315, 395, 330, 4, 60]
                        ]],
                        [546, 357, 608, 252, 678, 221, 6, 100, [
                            [590, 293, 646, 277, 648, 271, 2, 80]
                        ]]
                    ]]
                ],
                bloom: {
                    num: 700,
                    width: 1080,
                    height: 650,
                },
                footer: {
                    width: 1200,
                    height: 5,
                    speed: 10,
                }
            }

            var tree = new Tree(canvas[0], width, height, opts);
            var seed = tree.seed;
            var foot = tree.footer;
            var hold = 1;

            canvas.click(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                if (seed.hover(x, y)) {
                    hold = 0;
                    canvas.unbind("click");
                    canvas.unbind("mousemove");
                    canvas.removeClass('hand');
                }
            }).mousemove(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                canvas.toggleClass('hand', seed.hover(x, y));
            });

            var seedAnimate = eval(Jscex.compile("async", function () {
                seed.draw();
                while (hold) {
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canScale()) {
                    seed.scale(0.95);
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canMove()) {
                    seed.move(0, 2);
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
            }));

            var growAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.grow();
                    $await(Jscex.Async.sleep(10));
                } while (tree.canGrow());
            }));

            var flowAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.flower(2);
                    $await(Jscex.Async.sleep(10));
                } while (tree.canFlower());
            }));

            var moveAnimate = eval(Jscex.compile("async", function () {
                tree.snapshot("p1", 240, 0, 610, 680);
                while (tree.move("p1", 500, 0)) {
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
                foot.draw();
                tree.snapshot("p2", 500, 0, 610, 680);
                canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
                canvas.css("background", "#ffc0cb");
                $await(Jscex.Async.sleep(300));
                canvas.css("background", "none");
            }));

            var jumpAnimate = eval(Jscex.compile("async", function () {
                var ctx = tree.ctx;
                while (true) {
                    tree.ctx.clearRect(0, 0, width, height);
                    tree.jump();
                    foot.draw();
                    $await(Jscex.Async.sleep(25));
                }
            }));

            var textAnimate = eval(Jscex.compile("async", function () {
                var together = new Date();
                together.setFullYear(2024, 5, 1); 
                together.setHours(0);
                together.setMinutes(0);
                together.setSeconds(0);
                together.setMilliseconds(0);

                $("#code").show().typewriter();
                $("#clock-box").fadeIn(500);

                while (true) {
                    timeElapse(together);
                    $await(Jscex.Async.sleep(1000));
                }
            }));

            var runAsync = eval(Jscex.compile("async", function () {
                $await(seedAnimate());
                $await(growAnimate());
                $await(flowAnimate());
                $await(moveAnimate());
                textAnimate().start();
                $await(jumpAnimate());
            }));

            runAsync().start();
        })();
    </script>
</body>
</html>
